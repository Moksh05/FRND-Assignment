{"code":11000,"errorLabelSet":{},"errorResponse":{"code":11000,"errmsg":"E11000 duplicate key error collection: FRND.trucks index: truck_id_1 dup key: { truck_id: null }","index":0,"keyPattern":{"truck_id":1},"keyValue":{"truck_id":null}},"index":0,"keyPattern":{"truck_id":1},"keyValue":{"truck_id":null},"level":"error","message":"Failed to process Excel file E11000 duplicate key error collection: FRND.trucks index: truck_id_1 dup key: { truck_id: null }","stack":"MongoServerError: E11000 duplicate key error collection: FRND.trucks index: truck_id_1 dup key: { truck_id: null }\n    at InsertOneOperation.execute (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\operations\\insert.js:51:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async tryOperation (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:207:20)\n    at async executeOperation (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:75:16)\n    at async Collection.insertOne (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\collection.js:157:16)","timestamp":"2025-09-05T15:29:13.574Z"}
{"code":11000,"errorLabelSet":{},"errorResponse":{"code":11000,"errmsg":"E11000 duplicate key error collection: FRND.trucks index: truck_id_1 dup key: { truck_id: null }","index":0,"keyPattern":{"truck_id":1},"keyValue":{"truck_id":null}},"index":0,"keyPattern":{"truck_id":1},"keyValue":{"truck_id":null},"level":"error","message":"Failed to process Excel file E11000 duplicate key error collection: FRND.trucks index: truck_id_1 dup key: { truck_id: null }","stack":"MongoServerError: E11000 duplicate key error collection: FRND.trucks index: truck_id_1 dup key: { truck_id: null }\n    at InsertOneOperation.execute (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\operations\\insert.js:51:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async tryOperation (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:207:20)\n    at async executeOperation (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:75:16)\n    at async Collection.insertOne (D:\\FRND_Assignment\\server\\node_modules\\mongodb\\lib\\collection.js:157:16)","timestamp":"2025-09-05T15:32:18.990Z"}
{"_message":"Optimization validation failed","errors":{"companies.0.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.1.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.2.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"totalCost":{"kind":"required","message":"Path `totalCost` is required.","name":"ValidatorError","path":"totalCost","properties":{"message":"Path `totalCost` is required.","path":"totalCost","type":"required"}}},"level":"error","message":"Failed to optimize loads Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.","stack":"ValidationError: Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.\n    at Document.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:3358:32)\n    at Subdocument.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1480:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1132:16)\n    at EmbeddedDocument.Document (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:178:12)\n    at EmbeddedDocument.Subdocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n    at new EmbeddedDocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:144:17)\n    at SchemaDocumentArray.cast (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:509:22)\n    at SchemaType.applySetters (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schemaType.js:1258:12)","timestamp":"2025-09-05T15:34:10.322Z"}
{"_message":"Optimization validation failed","errors":{"companies.0.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.1.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.2.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"totalCost":{"kind":"required","message":"Path `totalCost` is required.","name":"ValidatorError","path":"totalCost","properties":{"message":"Path `totalCost` is required.","path":"totalCost","type":"required"}}},"level":"error","message":"Failed to optimize loads Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.","stack":"ValidationError: Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.\n    at Document.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:3358:32)\n    at Subdocument.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1480:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1132:16)\n    at EmbeddedDocument.Document (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:178:12)\n    at EmbeddedDocument.Subdocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n    at new EmbeddedDocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:144:17)\n    at SchemaDocumentArray.cast (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:509:22)\n    at SchemaType.applySetters (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schemaType.js:1258:12)","timestamp":"2025-09-05T15:35:42.424Z"}
{"_message":"Optimization validation failed","errors":{"companies.0.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.1.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.2.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"totalCost":{"kind":"required","message":"Path `totalCost` is required.","name":"ValidatorError","path":"totalCost","properties":{"message":"Path `totalCost` is required.","path":"totalCost","type":"required"}}},"level":"error","message":"Failed to optimize loads Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.","stack":"ValidationError: Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.\n    at Document.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:3358:32)\n    at Subdocument.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1480:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1132:16)\n    at EmbeddedDocument.Document (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:178:12)\n    at EmbeddedDocument.Subdocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n    at new EmbeddedDocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:144:17)\n    at SchemaDocumentArray.cast (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:509:22)\n    at SchemaType.applySetters (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schemaType.js:1258:12)","timestamp":"2025-09-05T16:34:29.663Z"}
{"_message":"Optimization validation failed","errors":{"companies.0.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.1.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"companies.2.cost":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"cost\"","name":"CastError","path":"cost","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"},"totalCost":{"kind":"required","message":"Path `totalCost` is required.","name":"ValidatorError","path":"totalCost","properties":{"message":"Path `totalCost` is required.","path":"totalCost","type":"required"}}},"level":"error","message":"Failed to optimize loads Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.","stack":"ValidationError: Optimization validation failed: companies.0.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.1.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", companies.2.cost: Cast to Number failed for value \"NaN\" (type number) at path \"cost\", totalCost: Path `totalCost` is required.\n    at Document.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:3358:32)\n    at Subdocument.invalidate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1480:12)\n    at EmbeddedDocument.$set (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:1132:16)\n    at EmbeddedDocument.Document (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:178:12)\n    at EmbeddedDocument.Subdocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n    at EmbeddedDocument.ArraySubdocument [as constructor] (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n    at new EmbeddedDocument (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:144:17)\n    at SchemaDocumentArray.cast (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schema\\documentArray.js:509:22)\n    at SchemaType.applySetters (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\schemaType.js:1258:12)","timestamp":"2025-09-05T16:36:14.070Z"}
{"level":"error","message":"Failed to optimize loads Cannot populate path `companies.trucks.truck` because it is not in your schema. Set the `strictPopulate` option to false to override.","path":"companies.trucks.truck","stack":"StrictPopulateError: Cannot populate path `companies.trucks.truck` because it is not in your schema. Set the `strictPopulate` option to false to override.\n    at getModelsMapForPopulate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\helpers\\populate\\getModelsMapForPopulate.js:50:12)\n    at _populatePath (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\model.js:4466:21)\n    at Function.populate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\model.js:4433:21)\n    at D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:2654:11\n    at _init (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:3330:5)\n    at Document.init (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:654:5)\n    at Document.$init (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:667:42)\n    at Object.createModelAndInit (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\queryHelpers.js:119:12)\n    at completeOne (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:3308:11)\n    at Query._completeOne (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:2650:3)","timestamp":"2025-09-05T16:37:28.171Z"}
{"level":"error","message":"Failed to optimize loads Cannot populate path `companies.optimize.truck` because it is not in your schema. Set the `strictPopulate` option to false to override.","path":"companies.optimize.truck","stack":"StrictPopulateError: Cannot populate path `companies.optimize.truck` because it is not in your schema. Set the `strictPopulate` option to false to override.\n    at getModelsMapForPopulate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\helpers\\populate\\getModelsMapForPopulate.js:50:12)\n    at _populatePath (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\model.js:4466:21)\n    at Function.populate (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\model.js:4433:21)\n    at D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:2654:11\n    at _init (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:3330:5)\n    at Document.init (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:654:5)\n    at Document.$init (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\document.js:667:42)\n    at Object.createModelAndInit (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\queryHelpers.js:119:12)\n    at completeOne (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:3308:11)\n    at Query._completeOne (D:\\FRND_Assignment\\server\\node_modules\\mongoose\\lib\\query.js:2650:3)","timestamp":"2025-09-05T16:40:00.599Z"}
{"level":"error","message":"Failed to optimize loads company.trucks is not iterable","stack":"TypeError: company.trucks is not iterable\n    at getOptimizedLoads (D:\\FRND_Assignment\\server\\controllers\\logisticscontroller.js:36:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","timestamp":"2025-09-05T16:44:49.059Z"}
{"level":"error","message":"Failed to generate report Optimization is not defined","stack":"ReferenceError: Optimization is not defined\n    at downloadReport (D:\\FRND_Assignment\\server\\controllers\\excelcontroller.js:71:26)\n    at Layer.handleRequest (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\layer.js:152:17)\n    at D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:295:15\n    at processParams (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:582:12)\n    at next (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:291:5)\n    at Function.handle (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:186:3)","timestamp":"2025-09-05T17:14:45.045Z"}
{"level":"error","message":"Failed to generate report Optimization is not defined","stack":"ReferenceError: Optimization is not defined\n    at downloadReport (D:\\FRND_Assignment\\server\\controllers\\excelcontroller.js:71:26)\n    at Layer.handleRequest (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (D:\\FRND_Assignment\\server\\node_modules\\router\\lib\\layer.js:152:17)\n    at D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:295:15\n    at processParams (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:582:12)\n    at next (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:291:5)\n    at Function.handle (D:\\FRND_Assignment\\server\\node_modules\\router\\index.js:186:3)","timestamp":"2025-09-05T17:14:48.685Z"}
